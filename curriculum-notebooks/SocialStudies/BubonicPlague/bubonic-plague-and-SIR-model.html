

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Bubonic Plage - SIR Model &#8212; Callysto Curriculum Notebooks</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-dropdown.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../../_static/togglebutton.js"></script>
    <script type="text/javascript" src="../../../_static/clipboard.min.js"></script>
    <script type="text/javascript" src="../../../_static/copybutton.js"></script>
    <script type="text/javascript" src="../../../_static/sphinx-book-theme.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script type="text/javascript">var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script type="text/javascript" src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" type="text/javascript" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script type="text/javascript">
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" type="text/javascript" src="../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="copyright" title="Copyright" href="../../../copyright.html" />
    <link rel="next" title="Geographic Progression of The American Revolution" href="../GeographyAmericanRevolution/geographic-progression-american-revolution.html" />
    <link rel="prev" title="Bubonic Plague" href="bubonic-plague-grade-8.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../index.html">
  
  <img src="../../../_static/CallystoLogo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Callysto Curriculum Notebooks</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../intro.html">
   Welcome to Callysto
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../README_modified.html">
   About the Notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Arts/Arts.html">
   Arts Section
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../EnglishLanguageArts/EnglishLangArts.html">
   English Language Arts Section
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Health/Health.html">
   Health Section
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Languages/Languages.html">
   Languages Section
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Mathematics/Mathematics.html">
   Mathematics Section
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Science/Sciences.html">
   Sciences Section
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="../SocialStudies.html">
   Social Studies Section
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="bubonic-plague-grade-8.html">
     Bubonic Plague
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Bubonic Plage - SIR Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../GeographyAmericanRevolution/geographic-progression-american-revolution.html">
     Geographic Progression of The American Revolution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../GeographyResidentialSchools/geography-of-residential-schools.html">
     Residential Schools in Canada
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Globalization/communication-and-globalization.html">
     Communication and Globalization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Globalization/languages-an-important-identity-in-globalizing-world.html">
     Languages: An important identity in globalizing world
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Globalization/migration-necessity-for-diversity.html">
     Migration: Necessity for diversity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Globalization/music-is-ubiquitous.html">
     Music is ubiquitous
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Globalization/sustainability-a-side-effect-of-globalization.html">
     Sustainability - A side-effect of globalization?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Globalization/trade-and-globalization.html">
     Trade and Globalization
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Mathematics/Statistics.html">
   Statistics Section
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../TechnologyStudies/Technology.html">
   Technology Section
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../afterword.html">
   Afterword
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/curriculum-notebooks/SocialStudies/BubonicPlague/bubonic-plague-and-SIR-model.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <
        
        
        <a class="jupyterhub-button" href="https://hub.callysto.ca/jupyter/hub/user-redirect/git-pull?repo=https%3A%2F%2Fgithub.com%2Fcallysto%2Fcurriculum-notebooks&branch=master&subPath=SocialStudies/BubonicPlague/bubonic-plague-and-SIR-model.ipynb&depth=1" target="_parent"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch JupyterHub" data-toggle="tooltip"
                data-placement="left"><img class="jupyterhub-button-logo"
                    src="../../../_static/images/logo_jupyterhub.svg"
                    alt="Interact on JupyterHub">JupyterHub</button></a>
        
        
        <
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#grade-11-social-studies">
   Grade 11 Social Studies
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-sir-outbreak-model">
   The SIR Outbreak Model
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#population-parameters">
     Population Parameters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#modelling-the-disease-progression">
     Modelling the disease progression
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#technical-remarks">
       Technical remarks.
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modelling-an-outbreak-related-to-the-great-plague-of-london">
   Modelling an outbreak related to the Great Plague of London
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#question-1">
     Question 1:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#question-2">
     Question 2:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#question-3">
     Question 3:
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#warning">
       Warning:
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulating-a-disease-outbreak">
   Simulating a Disease Outbreak
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#answer-1">
     Answer 1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#answer-2">
     Answer 2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#answer-3">
     Answer 3
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <p><img alt="Callysto.ca Banner" src="https://github.com/callysto/curriculum-notebooks/blob/master/callysto-notebook-banner-top.jpg?raw=true" /></p>
<p><a href="https://hub.callysto.ca/jupyter/hub/user-redirect/git-pull?repo=https%3A%2F%2Fgithub.com%2Fcallysto%2Fcurriculum-notebooks&branch=master&subPath=SocialStudies/BubonicPlague/bubonic-plague-and-SIR-model.ipynb&depth=1" target="_parent"><img src="https://raw.githubusercontent.com/callysto/curriculum-notebooks/master/open-in-callysto-button.svg?sanitize=true" width="123" height="24" alt="Open in Callysto"/></a></p>
<div class="section" id="bubonic-plage-sir-model">
<h1>Bubonic Plage - SIR Model<a class="headerlink" href="#bubonic-plage-sir-model" title="Permalink to this headline">¶</a></h1>
<div class="section" id="grade-11-social-studies">
<h2>Grade 11 Social Studies<a class="headerlink" href="#grade-11-social-studies" title="Permalink to this headline">¶</a></h2>
<p>We are interested in modelling a bubonic plague outbreak. We part from the assumption that the total population can be subdivided into a set of classes, each of which depends on the state of the infection. The <a class="reference external" href="https://en.wikipedia.org/wiki/Compartmental_models_in_epidemiology"><strong>SIR Model</strong></a> is the simplest one and, as its name suggests, it divides the population into three classes.</p>
<p><strong>Outcomes:</strong></p>
<ul class="simple">
<li><p>Examine and visualize concepts and examples related to the bubonic plague.</p></li>
<li><p>Examine the timeline/map of the Black Death.</p></li>
<li><p>Visualize mathematical model that shows the recovery, infection, and removal rates.</p></li>
</ul>
</div>
<div class="section" id="the-sir-outbreak-model">
<h2>The SIR Outbreak Model<a class="headerlink" href="#the-sir-outbreak-model" title="Permalink to this headline">¶</a></h2>
<div class="section" id="population-parameters">
<h3>Population Parameters<a class="headerlink" href="#population-parameters" title="Permalink to this headline">¶</a></h3>
<p>In this model, the total population is divided into three groups:</p>
<ul class="simple">
<li><p>Susceptible: individuals that can become infected but haven’t been yet</p></li>
<li><p>Infected: individuals that are infected</p></li>
<li><p>Removed: individuals that are either dead or recovered</p></li>
</ul>
<p>We are looking at the changes, over the course of an outbreak, of the numbers of these individuals, represented by <span class="math notranslate nohighlight">\(S\)</span>, <span class="math notranslate nohighlight">\(I\)</span>, and <span class="math notranslate nohighlight">\(R\)</span>. In other words we want to understand how, as time passes, the number of individuals in each group changes.</p>
<p>Having a realistic model might be useful for predicting the long-term outcome of an outbreak and informing public health interventions.</p>
<p>If we can predict that the number of removed people will stay low and the number of infected people will quickly go down to zero, then there is no need to intervene and we can let the outbreak end by itself while only providing medical attention to the infected people.</p>
<p>Conversely if we predict a large increase of the numbers of infected and removed individuals, then the outbreak needs a quick intervention before it results in a large number of casualties. In a plague outbreak this intervention would, for example, be to make sure there is no contact between infected and susceptible people.</p>
<p>We now describe the SIR (Susceptible, Infected, Removed) mathematical model of an outbreak over time (for example every week). We write <span class="math notranslate nohighlight">\(S_t, I_t, R_t\)</span> to denote the number of susceptible, infected, and removed individuals at time point <span class="math notranslate nohighlight">\(t\)</span>. <span class="math notranslate nohighlight">\(t=1\)</span> is the first recorded time point, <span class="math notranslate nohighlight">\(t=2\)</span> is the second and so on. We call <em>time unit</em> the time elapsed between two time points, for example a day or a week.</p>
<p>In this model, we assume that the <strong>total population is constant</strong> (so births and deaths are ignored) for the duration of the model simulation. We represent the total population size by <span class="math notranslate nohighlight">\(N\)</span>, and so at any time point <span class="math notranslate nohighlight">\(t\)</span> we have $<span class="math notranslate nohighlight">\(N=S_t + I_t + R_t\)</span>$</p>
</div>
<div class="section" id="modelling-the-disease-progression">
<h3>Modelling the disease progression<a class="headerlink" href="#modelling-the-disease-progression" title="Permalink to this headline">¶</a></h3>
<p>We assume that transmission requires contact between an infected individual and a susceptible individual. We also assume that the disease takes a constant amount of time to progress within an infected individual until they are removed (die or recover). We need to define these two processes (infection and removal) and model how they impact the transition from the time <span class="math notranslate nohighlight">\(t = (S_t,I_t,R_t)\)</span> to the next state <span class="math notranslate nohighlight">\(t + 1 = (S_{t+1},I_{t+1},R_{t+1})\)</span>.</p>
<p><img alt="SIR_1" src="../../../_images/SIR_1.jpg" /></p>
<p>The occurrences of new infections of is modelled using a parameter <span class="math notranslate nohighlight">\(\beta\)</span>, that gives the proportion of contacts between susceptible people and infected people, during one time unit, that results in infection. Then we can describe the number of newly infected people as <span class="math notranslate nohighlight">\(\dfrac{\beta S_t I_t}{N}\)</span>, where the term <span class="math notranslate nohighlight">\(S_t I_t\)</span> represents the set of all possible contacts between susceptible and infected individuals. We discuss this term later.</p>
<p>The occurrence of removals of infected people is modelled using a parameter denoted by <span class="math notranslate nohighlight">\(\gamma\)</span>. It is defined to be proportion of infected individuals that die or recover between two time points. If we are given that the duration of an infection is <span class="math notranslate nohighlight">\(T\)</span> (i.e. how many time points it takes for an individual between infection and removal), then <span class="math notranslate nohighlight">\(\gamma = \dfrac{1}{T}\)</span>.</p>
<p><img alt="SIR_2" src="../../../_images/SIR_2.jpg" /></p>
<p>Taking into account the rate of contact <span class="math notranslate nohighlight">\(\beta\)</span> and rate of removal <span class="math notranslate nohighlight">\(\gamma\)</span>, then each group population changes within one unit of time as follows</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
S_{t+1} &amp;= S_t -  \dfrac{{\beta} S_t I_t}{N}\\
I_{t+1} &amp;= I_t +  \dfrac{{\beta} S_t I_t}{N} - \gamma I_t \\
R_{t+1} &amp;= R_t + \gamma I_t\\
N&amp;=S_t + I_t + R_t
\end{align}
\end{split}\]</div>
<p>These equations form the SIR model. They allow, from knowing the parameters of the model (<span class="math notranslate nohighlight">\(\beta\)</span> and <span class="math notranslate nohighlight">\(\gamma\)</span>) and the current state (<span class="math notranslate nohighlight">\(S_t,I_t,R_t\)</span>) of a population to predict the next states of the population for later time points. Such models are critical in our days for monitoring and controlling infectious diseases outbreaks.</p>
<div class="section" id="technical-remarks">
<h4>Technical remarks.<a class="headerlink" href="#technical-remarks" title="Permalink to this headline">¶</a></h4>
<p>First, note that the SIR model does not enforce that the values <span class="math notranslate nohighlight">\(S_t,I_t,R_t\)</span> at a given time point are integers. As <span class="math notranslate nohighlight">\(\beta\)</span> and <span class="math notranslate nohighlight">\(\gamma\)</span> are actually floating numbers, these values are actually most of the time not integers. This is fine as the SIR model is an approximate model and aims mostly at predicting the general dynamics of an outbreak, not the precise values for the number of susceptible, infected, and removed individuals.</p>
<p>Next, one can ask how to find the values of the parameters <span class="math notranslate nohighlight">\(\beta\)</span> and <span class="math notranslate nohighlight">\(\gamma\)</span> that are necessary to have a full SIR model.</p>
<p>As discussed above, the parameter <span class="math notranslate nohighlight">\(\gamma\)</span> is relatively easy to find from knowing how the disease progress in a patient, as it is mostly the inverse of the average time a patient is sick.</p>
<p>The parameter <span class="math notranslate nohighlight">\(\beta\)</span> is less easy to obtain. Reading the equations we can see that during a time point, out of the <span class="math notranslate nohighlight">\(S_t\)</span> susceptible individuals, the number that get infected is <span class="math notranslate nohighlight">\((\dfrac{{\beta}}{N}) S_t I_t\)</span>. As mentioned above, the product <span class="math notranslate nohighlight">\(S_t I_t\)</span> can be interpreted as the set of all possible contacts between the <span class="math notranslate nohighlight">\(S_t\)</span> susceptible individuals and the <span class="math notranslate nohighlight">\(I_t\)</span> infected individuals and is often a large number, much larger than <span class="math notranslate nohighlight">\(S_t\)</span> and in the order of <span class="math notranslate nohighlight">\(N^2\)</span>. The division by <span class="math notranslate nohighlight">\(N\)</span> aims to lower this number, mostly to normalize it by the total population, to make sure it is in order of <span class="math notranslate nohighlight">\(N\)</span> and not quadratic in <span class="math notranslate nohighlight">\(N\)</span>. So in order for the number of newly infected individuals during a time unit to be reasonable, <span class="math notranslate nohighlight">\(\beta\)</span> is generally a  small number between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(1\)</span>. But formally, if we pick a value for <span class="math notranslate nohighlight">\(\beta\)</span> that is too large, then the SIR model will predict value for <span class="math notranslate nohighlight">\(S_t\)</span> that can be negative, which is inconsistent with the modelled phenomenon. So choosing the value of <span class="math notranslate nohighlight">\(\beta\)</span> is the crucial step in modelling an outbreak.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This function takes as input a vector y holding all initial values,</span>
<span class="c1">#    t: the number of time points (e.g. days)</span>
<span class="c1">#    beta: proportion of contacts that result in infections</span>
<span class="c1">#    gamma: proportion of infected that are removed</span>
<span class="c1">#    S1,I1,R1 = initial population sizes</span>

<span class="k">def</span> <span class="nf">discrete_SIR</span><span class="p">(</span><span class="n">S1</span><span class="p">,</span><span class="n">I1</span><span class="p">,</span><span class="n">R1</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">beta</span><span class="p">,</span><span class="n">gamma</span><span class="p">):</span>
    <span class="c1"># Empy arrays for each class</span>
    <span class="n">S</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># susceptible population</span>
    <span class="n">I</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># infected population</span>
    <span class="n">R</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># removed population</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">S1</span><span class="o">+</span><span class="n">I1</span><span class="o">+</span><span class="n">R1</span> <span class="c1"># the total population</span>
    
    <span class="c1"># Append initial values</span>
    <span class="n">S</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">S1</span><span class="p">)</span>
    <span class="n">I</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">I1</span><span class="p">)</span>
    <span class="n">R</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">R1</span><span class="p">)</span>
    
    <span class="c1"># apply SIR model: iterate over the total number of days - 1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">S_next</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">beta</span><span class="o">/</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="n">S</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">S_next</span><span class="p">)</span>
        
        <span class="n">I_next</span> <span class="o">=</span> <span class="n">I</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">beta</span><span class="o">/</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">-</span> <span class="n">gamma</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">I</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">I_next</span><span class="p">)</span>
        
        <span class="n">R_next</span> <span class="o">=</span> <span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">I</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">R</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">R_next</span><span class="p">)</span>
    
    <span class="c1"># return arrays S,I,R whose entries are various values for susceptible, infected, removed </span>
    <span class="k">return</span><span class="p">((</span><span class="n">S</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="n">R</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="modelling-an-outbreak-related-to-the-great-plague-of-london">
<h2>Modelling an outbreak related to the Great Plague of London<a class="headerlink" href="#modelling-an-outbreak-related-to-the-great-plague-of-london" title="Permalink to this headline">¶</a></h2>
<p>The last major epidemic of the bubonic plague in England occurred between 1665 and 1666 (<a class="reference external" href="https://www.britannica.com/event/Great-Plague-of-London">click here for further reading</a>). This epidemic did not kill as many people as the Black Death (1347 - 1351), however it is remembered as the “Great Plague of London” as it was the last widespread outbreak that affected England.</p>
<p>“City records indicate that some 68,596 people died during the epidemic, though the actual number of deaths is suspected to have exceeded 100,000 out of a total population estimated at 460,000. ” <a class="reference external" href="https://www.britannica.com/event/Great-Plague-of-London">Great Plague of London”; Encyclopædia Britannica; Encyclopædia Britannica, inc.; September 08, 2016</a></p>
<p>When the bubonic plague outbreak hit London, people started to leave the city and go to the countryside, hoping to avoid the disease. But as can be expected, some of these people were already infected when they left London, and so carried the disease to start other outbreaks in some nearby villages. This happened in the village of Eyam.</p>
<p>When Eyam authorities realized a plague outbreak had started, they took the difficult decision to close the village in order to avoid to spread the disease further. So nobody was allowed to enter or leave the village and people stayed there hoping the outbreak would end by itself without too many casualties; note that from a mathematical point of view, that implies that the assumption that the sum of the numbers of susceptible, infected and removed individuals, the population, is constant.</p>
<p>Also the village authorities recorded regularly the number of infected and dead people; these data are described in the table below, for the period from June 19 1665 to October 19 1665, with data being recorded every 2 weeks. Obviously these data are imperfect (some people did not declare they were sick by fear of being ostracized, some people died too fast for the plague to be diagnosed, etc.), but nevertheless, they provide us with interesting data to see if the SIR model is an appropriate model for such a plague outbreak.</p>
<p>| Date  |Day Number |Susceptible | Infected |
|——-||————-|———-|
|June 19 1665|0|254|7|
|July 3 1665|14|235|14|
|July 19 1665|28|201|22|
|Aug 3 1665|42|153|29|
|Aug 19 1665|56|121| 21|
|Sept 3 1665|70|108|8|
|Sept 19 1665|84|121|21|
|Oct 3 1665| 98|NA | NA|
|Oct 19 1665|112| 83 | 0|</p>
<p>The average time an infected individual remains infected by the bubonic plague is 11 days.</p>
<p>With the information above, we will be able to get the parameters of the SIR model for this outbreak and observe if indeed what this model predicts generates results corresponding to what happened in reality.</p>
<div class="section" id="question-1">
<h3>Question 1:<a class="headerlink" href="#question-1" title="Permalink to this headline">¶</a></h3>
<p>Assuming that on June 19 no individuals had died, i.e. no one was in the Removed class, what is the value of <span class="math notranslate nohighlight">\(N\)</span>, i.e. the number of individuals in the total population?</p>
</div>
<div class="section" id="question-2">
<h3>Question 2:<a class="headerlink" href="#question-2" title="Permalink to this headline">¶</a></h3>
<p>We know that the average time an individual remained infected is 11 days. What is the rate of removal (<span class="math notranslate nohighlight">\(\gamma\)</span>)?</p>
</div>
<div class="section" id="question-3">
<h3>Question 3:<a class="headerlink" href="#question-3" title="Permalink to this headline">¶</a></h3>
<p>We are now trying something more difficult but more interesting. We introduced a mathematical model for outbreaks, but nothing so far shows that this SIR model is appropriate to model an outbreak such as the Eyam plague outbreak. We want to answer this question now.</p>
<p>From questions 1 and 2 above we know the values of <span class="math notranslate nohighlight">\(N\)</span> and <span class="math notranslate nohighlight">\(\gamma\)</span> (check your answers at the bottom of this notebook). From the data table we also know <span class="math notranslate nohighlight">\(S_1,I_1,R_1\)</span>, the state of the population at the start of the outbreak. So if we want to apply the SIR model we need to find  a value for <span class="math notranslate nohighlight">\(\beta\)</span> the parameter, the number susceptible people becoming infected during a time unit. We consider here that a time unit is 1 day; the Eyam outbreak spanned 112 days, so 112 time units, even if data were only recorded every 2 weeks.</p>
<p>A standard scientific approach for the problem of finding <span class="math notranslate nohighlight">\(\beta\)</span> is to try various values and see if there is one that leads to predicted values for <span class="math notranslate nohighlight">\(S_n,I_n,R_n\)</span> that match the observed data. In order to evaluate this match, we focus on the number of infected people, the most important element of an outbreak.</p>
<p>The code below allows you to do this: you can choose a value of <span class="math notranslate nohighlight">\(\beta\)</span>, click on the “Run interact” button and it will show on the same graph a set of 8 blue dots (the observed number of infected people from the data table) and a set of 112 red dots, corresponding to the predicted number of infected individuals for the chosen value of <span class="math notranslate nohighlight">\(\beta\)</span>.</p>
<p>While there are several mathematical ways to define what would be the <em>best fit</em>, here we are not getting into this and you are just asked to try to find a value of <span class="math notranslate nohighlight">\(\beta\)</span> that generated blue dots being approximately on the graph defined by the red dots. Pay particular attention to the first four blue dots.</p>
<p>Note that in this case <span class="math notranslate nohighlight">\(0 &lt; \beta &lt; 1\)</span>.</p>
<div class="section" id="warning">
<h4>Warning:<a class="headerlink" href="#warning" title="Permalink to this headline">¶</a></h4>
<p>The SIR model is a very simple approximation of the dynamics of a true outbreak, so don’t expect to find a value of <span class="math notranslate nohighlight">\(\beta\)</span> that generates a graph that contains exactly all observed data points (blue dots).</p>
<p>In particular note that the data from September 3 and 19 seem to be somewhat of an anomaly as we observe a sharp decrease in the number of infected followed by a surge. This could be due to many reasons, for example poor statistics recording (we are considering a group of people under heavy stress likely more motivated by trying to stay alive than to record accurate vital statistics).</p>
<p>So here we are interested in finding a parameter <span class="math notranslate nohighlight">\(\beta\)</span> that captures the general dynamics (increase followed by a post-peak decrease) of the outbreak. You can expect to find a reasonable value for <span class="math notranslate nohighlight">\(\beta\)</span> but be aware that many values, especially too high, will result in a very poor match between observed data and model predictions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact_manual</span><span class="p">,</span> <span class="n">interact</span><span class="p">,</span><span class="n">widgets</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># set style</span>
<span class="n">s</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">}</span>

<span class="c1"># Set interact manual box widget for beta</span>
<span class="nd">@interact</span><span class="p">(</span><span class="n">answer</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatText</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Enter beta &#39;</span><span class="p">,</span>
    <span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.01</span>
<span class="p">))</span>

<span class="c1"># define function to find the appropriate value of beta</span>
<span class="c1"># this function takes as input a floating value and outputs a plot with the best fit curve</span>
<span class="k">def</span> <span class="nf">find_beta</span><span class="p">(</span><span class="n">answer</span><span class="p">):</span>
    
    <span class="c1"># set initial values for SIR model</span>
    <span class="n">S1</span><span class="p">,</span><span class="n">I1</span><span class="p">,</span><span class="n">R1</span> <span class="o">=</span> <span class="mi">254</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">0</span>
    
    <span class="c1"># Use original data on Number of infected from table in the notebook</span>
    <span class="n">ori_data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="c1"># use days, time data was provided biweekly, we transform to days here</span>
    <span class="n">ori_days</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">42</span><span class="p">,</span><span class="mi">56</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">84</span><span class="p">,</span><span class="mi">112</span><span class="p">]</span>
    
    <span class="c1"># set number of days as the second to last entry on the ori_days array </span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">ori_days</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">ori_days</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">ori_days</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="c1"># get beta from answer - to be sure transform to float</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">answer</span><span class="p">)</span>
    
    <span class="c1"># Gamma was obtained from disease</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">11</span>
    
    <span class="c1"># Compute SIR values using our discrete_SIR function</span>
    <span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">=</span> <span class="n">discrete_SIR</span><span class="p">(</span><span class="n">S1</span><span class="p">,</span><span class="n">I1</span><span class="p">,</span><span class="n">R1</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">beta</span><span class="p">,</span><span class="n">gamma</span><span class="p">)</span>
    
    <span class="c1"># Figure</span>
    <span class="c1">#fig,ax = plt.subplot(figsize=(10,10))</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">ax</span>  <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span><span class="n">facecolor</span> <span class="o">=</span> <span class="s1">&#39;#ffffff&#39;</span><span class="p">)</span>
    <span class="c1"># Scatter plot of original number of infected in the course of 112 days</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ori_days</span><span class="p">,</span><span class="n">ori_data</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Original Data&quot;</span><span class="p">)</span>
    
    <span class="c1"># Scatter plot of infected obtained from SIR mode, in the course of 112 days</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="n">I</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;SIR Model Predictions&quot;</span><span class="p">)</span>
    
    <span class="c1"># Make the plot pretty</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (days)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Infected Individuals&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Real Data vs Model&#39;</span><span class="p">)</span>
    <span class="c1">#legend = ax.legend()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "3b9d12b708b74f5fa8578702358a9bcc", "version_major": 2, "version_minor": 0}
</script></div>
</div>
</div>
</div>
</div>
<div class="section" id="simulating-a-disease-outbreak">
<h2>Simulating a Disease Outbreak<a class="headerlink" href="#simulating-a-disease-outbreak" title="Permalink to this headline">¶</a></h2>
<p>To conclude we will use the widgets below to simulate a disease outbreak using the SIR model.
You can choose the values of all the elements of the model (sizes of the compartments of the population at the beginning of the outbreak, parameters <span class="math notranslate nohighlight">\(\gamma\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span>, and duration in time units (days) of the outbreak. The default parameters are the ones from the Eyam plague outbreak.</p>
<p>The result is a series of three graphs that shows how the three components of the population change during the outbreak. It allows you to see the impact of changes in the parameters <span class="math notranslate nohighlight">\(\gamma\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span>, such as increasing <span class="math notranslate nohighlight">\(\beta\)</span> (making the outbreak progress faster) or reducing <span class="math notranslate nohighlight">\(\gamma\)</span> (decreasing the removal rate).</p>
<p>You can use this interactive tool to try to fit the SIR model to match the observed data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="n">ceil</span>

<span class="c1"># This function takes as input initial values of susceptible, infected and removed, number of days, beta and gamma</span>
<span class="c1"># it plots the SIR model with the above conditions</span>
<span class="k">def</span> <span class="nf">plot_SIR</span><span class="p">(</span><span class="n">S1</span><span class="p">,</span><span class="n">I1</span><span class="p">,</span><span class="n">R1</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">beta</span><span class="p">,</span><span class="n">gamma</span><span class="p">):</span>
    
    <span class="c1"># Initialize figure</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">ax</span>  <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span><span class="n">facecolor</span> <span class="o">=</span> <span class="s1">&#39;#ffffff&#39;</span><span class="p">)</span>
    
    <span class="c1"># Compute SIR values for our initial data and parameters</span>
    <span class="p">(</span><span class="n">S_f</span><span class="p">,</span><span class="n">I_f</span><span class="p">,</span><span class="n">R_f</span><span class="p">)</span> <span class="o">=</span> <span class="n">discrete_SIR</span><span class="p">(</span><span class="n">S1</span><span class="p">,</span><span class="n">I1</span><span class="p">,</span><span class="n">R1</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">beta</span><span class="p">,</span><span class="n">gamma</span><span class="p">)</span>    
    
    <span class="c1"># Set x axis</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
   
    <span class="c1"># Scatter plot of evolution of susceptible over the course of x days</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">S_f</span><span class="p">,</span><span class="n">c</span><span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Susceptible&#39;</span><span class="p">)</span>
    
    <span class="c1"># Scatter plot of evolution of infected over the course of x days</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">I_f</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Infected&#39;</span><span class="p">)</span>
    
    <span class="c1"># Scatter plot of evolution of removed over the course of x days</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">R_f</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Removed&#39;</span><span class="p">)</span>

    <span class="c1"># Make the plot pretty</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (days)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Number of individuals&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Simulation of a Disease Outbreak Using the SIR Model&#39;</span><span class="p">)</span>
    <span class="n">legend</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="c1"># Print messages to aid student understand and interpret what is happening in the plot</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SIMULATION DATA</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Beta: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">beta</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Gamma: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">gamma</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Initial Conditions:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total number of Susceptible: &quot;</span>  <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ceil</span><span class="p">(</span><span class="n">S_f</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total number of Infected: &quot;</span>  <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ceil</span><span class="p">(</span><span class="n">I_f</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total number of Removed: &quot;</span>  <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ceil</span><span class="p">(</span><span class="n">R_f</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; days:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total number of Susceptible: &quot;</span>  <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ceil</span><span class="p">(</span><span class="n">S_f</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">])))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total number of Infected: &quot;</span>  <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ceil</span><span class="p">(</span><span class="n">I_f</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total number of Removed: &quot;</span>  <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ceil</span><span class="p">(</span><span class="n">R_f</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">])))</span>

<span class="c1"># Tweaking initial Values</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">widgets</span><span class="p">,</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interact_manual</span>

<span class="c1"># Set function above so that the user can set all parameters and manually start simulation</span>
<span class="n">s</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">}</span>
<span class="n">interact</span><span class="p">(</span><span class="n">plot_SIR</span><span class="p">,</span>
        <span class="n">S1</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">254</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Susceptible Initial&quot;</span><span class="p">,</span> 
                               <span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">readout</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="n">I1</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Infected Initial&quot;</span><span class="p">,</span>
                               <span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">readout</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="n">R1</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Removed Initial&quot;</span><span class="p">,</span>
                               <span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">readout</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">112</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Time (days)&quot;</span><span class="p">,</span>
                              <span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">readout</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatText</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">1.50</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$ \beta$ parameter&#39;</span><span class="p">,</span>
                                 <span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">style</span> <span class="o">=</span> <span class="n">s</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.01</span><span class="p">),</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatText</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">1.50</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$ \gamma$ parameter&#39;</span><span class="p">,</span>
                                  <span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
        <span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "77389a72e7524dc2acd80830c0295aed", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<div class="section" id="answer-1">
<h3>Answer 1<a class="headerlink" href="#answer-1" title="Permalink to this headline">¶</a></h3>
<p>Since we are assuming the population is constant, and since <span class="math notranslate nohighlight">\(S_1 = 254, I_1 = 7, R_1 = 0\)</span>, then  <span class="math notranslate nohighlight">\(S_1 + I_1 + R_1 = 254 + 7 + 0  = 261\)</span>.</p>
</div>
<div class="section" id="answer-2">
<h3>Answer 2<a class="headerlink" href="#answer-2" title="Permalink to this headline">¶</a></h3>
<p>We know that, on average, an individual will remain infected for approximately 11 days. This means that one individual moves to the removed class for every 11 days, and the rate of removal is <span class="math notranslate nohighlight">\(\gamma = \frac{1}{11} = 0.0909...\)</span>.</p>
</div>
<div class="section" id="answer-3">
<h3>Answer 3<a class="headerlink" href="#answer-3" title="Permalink to this headline">¶</a></h3>
<p>The best value is approximately <span class="math notranslate nohighlight">\(\beta = 0.14909440503418078\)</span>.</p>
<h2 align='center'>Conclusion</h2>
<p>In this notebook we learned about the SIR discrete model to model an outbreak. We learned that this model is one of the simplest ones and that it separates the total population <span class="math notranslate nohighlight">\(N\)</span> (a constant) into three categories: Infected, Susceptible and Removed. We learned about rates of infection and removal and how this affects the number of individuals in each class.</p>
<p>We also ran a basic but realistic simulation of a bubonic plague outbreak of the Great Plague of London that took place in the village Eyam in 1665 and learned about the devastating effect this had on the population.</p>
<p><a class="reference external" href="https://github.com/callysto/curriculum-notebooks/blob/master/LICENSE.md"><img alt="Callysto.ca License" src="https://github.com/callysto/curriculum-notebooks/blob/master/callysto-notebook-banner-bottom.jpg?raw=true" /></a></p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./curriculum-notebooks/SocialStudies/BubonicPlague"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="bubonic-plague-grade-8.html" title="previous page">Bubonic Plague</a>
    <a class='right-next' id="next-link" href="../GeographyAmericanRevolution/geographic-progression-american-revolution.html" title="next page">Geographic Progression of The American Revolution</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Callysto.ca (A joint project of Cybera Inc and the Pacific Institute for the Mathematical Sciences)<br/>
        
            &copy; <a href="../../../copyright.html">Copyright</a> 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../../../_static/js/index.js"></script>
    
  </body>
</html>